<!DOCTYPE html>
<html>
  <head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.11.2/p5.min.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.11.2/addons/p5.sound.min.js" crossorigin="anonymous"></script>
  </head>
  <body>
    <script>
      let mic;
      let temblar;

      function setup() {
        createCanvas(windowWidth, windowHeight);
        mic = new p5.AudioIn();
        mic.start();
      }

      function draw() {
        temblar = random(10, 50);
        let vol = mic.getLevel();
        let h = map(vol, 0, 1, 0, 800);

        background(0, 255 - h, 155);

        // Cara
        fill(217, 190 + h, 150);
        ellipse(windowWidth / 2, windowHeight / 2, 300 + temblar, 300 + temblar);

        // Orejas (más felinas)
        push();
        fill(217, 190 + h, 150);
        stroke(150, 100, 70, 100);
        strokeWeight(2);
        // Oreja izquierda
        triangle(
          windowWidth / 2 - 110, windowHeight / 2 - 100,
          windowWidth / 2 - 170, windowHeight / 2 - 220,
          windowWidth / 2 - 40, windowHeight / 2 - 130
        );
        // Oreja derecha
        triangle(
          windowWidth / 2 + 110, windowHeight / 2 - 100,
          windowWidth / 2 + 170, windowHeight / 2 - 220,
          windowWidth / 2 + 40, windowHeight / 2 - 130
        );
        pop();

        // Gorra hacia el lado izquierdo (roja)
        push();
        let gorraX = windowWidth / 2 - 60;
        let gorraY = windowHeight / 2 - 140;
        fill(200, 30, 50);
        arc(gorraX, gorraY, 110, 60, PI, 0, CHORD);
        fill(80, 0, 20);
        arc(gorraX - 28, gorraY + 2, 42, 25, 0, PI, OPEN);
        pop();

        // Ojos (más tipo gato)
        fill(255 + h / 2, 255, 255);
        ellipse(windowWidth / 2 - 60 + h * 2, windowHeight / 2 - 30 + h * 2, 55, 35);
        ellipse(windowWidth / 2 + 60 + h * 2, windowHeight / 2 - 30 + h * 2, 55, 35);

        // Pupilas verticales
        fill(30, 180, 90);
        ellipse(windowWidth / 2 - 60 + h * 2, windowHeight / 2 - 30 + h * 2, 12, 32);
        ellipse(windowWidth / 2 + 60 + h * 2, windowHeight / 2 - 30 + h * 2, 12, 32);

        // Cejas: más felinas y expresivas
        stroke(50, 30, 0);
        strokeWeight(6);
        noFill();
        // Ceja izquierda (arqueada tipo gato)
        beginShape();
        curveVertex(windowWidth / 2 - 100, windowHeight / 2 - 75);
        curveVertex(windowWidth / 2 - 80, windowHeight / 2 - 90 - h * 0.03);
        curveVertex(windowWidth / 2 - 45, windowHeight / 2 - 80 - h * 0.02);
        endShape();
        // Ceja derecha (arqueada tipo gato)
        beginShape();
        curveVertex(windowWidth / 2 + 100, windowHeight / 2 - 75);
        curveVertex(windowWidth / 2 + 80, windowHeight / 2 - 90 - h * 0.03);
        curveVertex(windowWidth / 2 + 45, windowHeight / 2 - 80 - h * 0.02);
        endShape();

        // Nariz de gato (triángulo rosado)
        noStroke();
        fill(255, 120, 180);
        triangle(
          windowWidth / 2 - 18, windowHeight / 2 + 20,
          windowWidth / 2 + 18, windowHeight / 2 + 20,
          windowWidth / 2, windowHeight / 2 + 45
        );
        // Línea nariz-boca
        stroke(160, 80, 120);
        strokeWeight(3);
        line(windowWidth / 2, windowHeight / 2 + 45, windowWidth / 2, windowHeight / 2 + 80);

        // Boca centrada y expresiva (gato)
        noFill();
        stroke(255, 50, 50);
        strokeWeight(5);
        arc(windowWidth / 2 - 13, windowHeight / 2 + 80, 30, 20 + h * 0.1, 0, PI, OPEN);
        arc(windowWidth / 2 + 13, windowHeight / 2 + 80, 30, 20 + h * 0.1, 0, PI, OPEN);

        // Bigotes
        stroke(80, 60, 30, 180);
        strokeWeight(3);
        // Izquierda
        line(windowWidth / 2 - 18, windowHeight / 2 + 32, windowWidth / 2 - 70, windowHeight / 2 + 25);
        line(windowWidth / 2 - 18, windowHeight / 2 + 38, windowWidth / 2 - 75, windowHeight / 2 + 38);
        line(windowWidth / 2 - 18, windowHeight / 2 + 44, windowWidth / 2 - 70, windowHeight / 2 + 54);
        // Derecha
        line(windowWidth / 2 + 18, windowHeight / 2 + 32, windowWidth / 2 + 70, windowHeight / 2 + 25);
        line(windowWidth / 2 + 18, windowHeight / 2 + 38, windowWidth / 2 + 75, windowHeight / 2 + 38);
        line(windowWidth / 2 + 18, windowHeight / 2 + 44, windowWidth / 2 + 70, windowHeight / 2 + 54);
      }
    </script>
  </body>
</html>
